<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Aures Click Elite</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.1.6/purify.min.js"></script>

<script>
tailwind.config = {
  darkMode: 'class',
  theme: { extend: { colors:{ ai:'#4f46e5', vendor:'#10b981', danger:'#ef4444' } } }
}
</script>

<style>
body{font-family:Cairo,sans-serif}
.view{display:none}
.view.active{display:block}
.card-hover:hover{transform:translateY(-8px)}
</style>
</head>

<body class="bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100">

<!-- NAV -->
<nav class="sticky top-0 bg-white dark:bg-slate-900 shadow px-4 py-3 z-50">
<div class="max-w-7xl mx-auto flex justify-between items-center">
<h1 onclick="app.show('home')" class="font-black text-xl cursor-pointer text-ai">AURES CLICK</h1>

<div class="flex gap-3">
<button onclick="app.toggleTheme()" class="px-3 py-2 bg-slate-200 dark:bg-slate-800 rounded">ğŸŒ“</button>
<button onclick="app.toggleCart()" class="px-3 py-2 bg-ai text-white rounded">ğŸ›’ <span id="cart-count">0</span></button>
<button onclick="app.toggleMobile()" class="lg:hidden px-3 py-2 bg-slate-200 dark:bg-slate-800 rounded">â˜°</button>
</div>
</div>

<div id="mobile-menu" class="hidden mt-4 flex flex-col gap-3 text-sm font-bold">
<button onclick="app.show('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
<button onclick="app.show('marketplace')">Ø§Ù„Ù…ØªØ¬Ø±</button>
</div>
</nav>

<!-- HOME -->
<section id="view-home" class="view active max-w-7xl mx-auto p-6">

<input id="search" placeholder="Ø¨Ø­Ø«..." class="w-full p-3 rounded bg-white dark:bg-slate-800 mb-6"/>

<div class="flex gap-2 mb-6">
<button data-cat="all" class="cat bg-ai text-white px-4 py-2 rounded">Ø§Ù„ÙƒÙ„</button>
<button data-cat="tech" class="cat bg-slate-200 dark:bg-slate-800 px-4 py-2 rounded">ØªÙ‚Ù†ÙŠØ©</button>
<button data-cat="fashion" class="cat bg-slate-200 dark:bg-slate-800 px-4 py-2 rounded">Ù…ÙˆØ¶Ø©</button>
</div>

<div id="products-grid" class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
</section>

<!-- MARKET -->
<section id="view-marketplace" class="view max-w-7xl mx-auto p-6">
<h2 class="text-3xl font-black mb-6">Ø§Ù„Ù…ØªØ¬Ø±</h2>
<div id="marketplace-grid" class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
</section>

<!-- CART -->
<div id="cart" class="fixed right-0 top-0 h-full w-full max-w-md bg-white dark:bg-slate-900 shadow transform translate-x-full transition p-6 overflow-y-auto">
<h3 class="font-black text-xl mb-4">Ø§Ù„Ø³Ù„Ø©</h3>
<div id="cart-items" class="space-y-4"></div>
<div class="mt-6 font-black">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="cart-total">0</span> Ø¯Ø¬</div>
<button onclick="app.checkout()" class="mt-4 w-full bg-vendor text-white py-3 rounded">ØªØ£ÙƒÙŠØ¯</button>
</div>

<script>
const FALLBACK_IMG="https://via.placeholder.com/600x800?text=No+Image";

class StoreApp {

state={
products:[
{id:1,name:"Sony A7 IV",price:340000,cat:"tech",stock:3,img:"https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=800"},
{id:2,name:"Ø¬Ø§ÙƒÙŠØª",price:18000,cat:"fashion",stock:10,img:"https://images.unsplash.com/photo-1551028719-00167b16eac5?w=800"},
{id:3,name:"Razer Blade",price:290000,cat:"tech",stock:2,img:"https://images.unsplash.com/photo-1611078489935-0cb4c2497a00?w=800"},
],
cart:JSON.parse(localStorage.getItem("cart")||"[]"),
cat:"all",
q:""
}

init(){
this.bind()
this.render()
this.updateCart()
this.applyTheme(localStorage.getItem("theme")==="dark")
}

bind(){

// categories
document.querySelectorAll(".cat").forEach(b=>{
b.onclick=()=>{
this.state.cat=b.dataset.cat
this.render()
}
})

// debounce search
let t
search.oninput=e=>{
clearTimeout(t)
t=setTimeout(()=>{
this.state.q=e.target.value.toLowerCase()
this.render()
},300)
}

}

show(v){
document.querySelectorAll(".view").forEach(x=>x.classList.remove("active"))
document.getElementById("view-"+v).classList.add("active")
}

toggleMobile(){
mobile-menu.classList.toggle("hidden")
}

toggleTheme(){
const dark=!document.documentElement.classList.contains("dark")
this.applyTheme(dark)
localStorage.setItem("theme",dark?"dark":"light")
}

applyTheme(dark){
document.documentElement.classList.toggle("dark",dark)
}

sanitize(x){return DOMPurify.sanitize(x)}

imgTag(src){
return `<img loading="lazy" onerror="this.src='${FALLBACK_IMG}'"
class="w-full h-64 object-cover"
src="${this.sanitize(src)}">`
}

render(){

const list=this.state.products.filter(p=>{
return (this.state.cat==="all"||p.cat===this.state.cat)
&& p.name.toLowerCase().includes(this.state.q)
})

const html=list.map(p=>{

const disabled=p.stock===0

return `
<div class="bg-white dark:bg-slate-800 rounded shadow card-hover">
${this.imgTag(p.img)}
<div class="p-4">
<h4 class="font-bold">${this.sanitize(p.name)}</h4>
<p class="text-ai font-black">${p.price.toLocaleString()} Ø¯Ø¬</p>
<p class="text-xs opacity-60">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${p.stock}</p>
<button ${disabled?"disabled":""}
onclick="app.add(${p.id})"
class="mt-3 w-full py-2 rounded ${disabled?"bg-slate-400":"bg-ai text-white"}">
${disabled?"Ù†ÙØ°":"Ø£Ø¶Ù"}
</button>
</div>
</div>`
}).join("")

products-grid.innerHTML=html
marketplace-grid.innerHTML=html
}

add(id){
const p=this.state.products.find(x=>x.id===id)
if(!p||p.stock<=0) return

const c=this.state.cart.find(x=>x.id===id)
if(c){ 
if(c.qty>=p.stock) return alert("ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")
c.qty++
}else{
this.state.cart.push({...p,qty:1})
}

this.updateCart()
}

remove(id){
this.state.cart=this.state.cart.filter(x=>x.id!==id)
this.updateCart()
}

updateCart(){
localStorage.setItem("cart",JSON.stringify(this.state.cart))

cart-count.innerText=this.state.cart.reduce((s,i)=>s+i.qty,0)

cart-items.innerHTML=this.state.cart.map(i=>`
<div class="flex justify-between bg-slate-100 dark:bg-slate-800 p-3 rounded">
<div>
<div class="font-bold">${this.sanitize(i.name)}</div>
<div>${i.price.toLocaleString()} Ø¯Ø¬ Ã— ${i.qty}</div>
</div>
<button onclick="app.remove(${i.id})" class="text-danger">Ã—</button>
</div>`).join("")

const total=this.state.cart.reduce((s,i)=>s+i.price*i.qty,0)
cart-total.innerText=total.toLocaleString()
}

toggleCart(){
cart.classList.toggle("translate-x-full")
}

checkout(){
if(!this.state.cart.length) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©")

// Ø®ØµÙ… Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
this.state.cart.forEach(ci=>{
const p=this.state.products.find(x=>x.id===ci.id)
p.stock-=ci.qty
})

this.state.cart=[]
this.updateCart()
this.render()
alert("ØªÙ… Ø§Ù„Ø·Ù„Ø¨")
}

}

const app=new StoreApp()
app.init()
</script>

</body>
</html>