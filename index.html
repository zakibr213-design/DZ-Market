<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aures Click Elite</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.1.6/purify.min.js"></script>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: { ai: '#4f46e5', vendor: '#10b981', danger: '#ef4444' }
        }
      }
    }
  </script>

  <style>
    :root { --bg: theme('colors.slate.50'); --text: theme('colors.slate.900'); }
    .dark { --bg: theme('colors.slate.950'); --text: theme('colors.slate.100'); }
    body {
      font-family: 'Cairo', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      transition: background-color 0.4s, color 0.4s;
    }
    .view { display: none; }
    .view.active { display: block; }
    .card { transition: transform 0.25s ease, box-shadow 0.25s ease; }
    .card:hover { transform: translateY(-6px); box-shadow: 0 20px 40px -10px rgba(0,0,0,0.12); }
    .img-container { aspect-ratio: 4/5; overflow: hidden; }
  </style>
</head>
<body class="min-h-screen">

<!-- â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav class="sticky top-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 px-4 py-3.5">
  <div class="max-w-7xl mx-auto flex items-center justify-between">
    <h1 onclick="app.show('home')" class="text-2xl font-black text-ai cursor-pointer select-none">AURES CLICK</h1>

    <div class="flex items-center gap-3">
      <button onclick="app.toggleTheme()" class="p-2.5 rounded-lg bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition">
        ğŸŒ“
      </button>
      <button onclick="app.toggleCart()" class="relative p-2.5 rounded-lg bg-ai/10 text-ai hover:bg-ai/20 transition">
        ğŸ›’
        <span id="cart-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold min-w-[18px] h-5 px-1.5 rounded-full flex items-center justify-center">0</span>
      </button>
      <button onclick="app.toggleMobileMenu()" class="lg:hidden p-2.5 rounded-lg bg-slate-100 dark:bg-slate-800">
        â˜°
      </button>
    </div>
  </div>

  <div id="mobile-menu" class="hidden lg:hidden mt-3 px-4 py-3 bg-white dark:bg-slate-900 border-t dark:border-slate-800">
    <div class="flex flex-col gap-4 font-medium">
      <button onclick="app.show('home'); app.toggleMobileMenu()">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      <button onclick="app.show('marketplace'); app.toggleMobileMenu()">Ø§Ù„Ù…ØªØ¬Ø±</button>
    </div>
  </div>
</nav>

<!-- â”€â”€ Main Content â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<main class="max-w-7xl mx-auto p-5 md:p-6">

  <section id="view-home" class="view active">
    <input id="search-input" type="search"
           placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..."
           class="w-full p-4 mb-6 rounded-xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-ai focus:ring-2 focus:ring-ai/30 outline-none transition"/>

    <div class="flex flex-wrap gap-2.5 mb-8">
      <button data-cat="all"      class="cat-btn px-5 py-2.5 rounded-lg font-medium bg-ai text-white">Ø§Ù„ÙƒÙ„</button>
      <button data-cat="tech"     class="cat-btn px-5 py-2.5 rounded-lg font-medium bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 transition">ØªÙ‚Ù†ÙŠØ©</button>
      <button data-cat="fashion"  class="cat-btn px-5 py-2.5 rounded-lg font-medium bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 transition">Ù…ÙˆØ¶Ø©</button>
    </div>

    <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
  </section>

  <section id="view-marketplace" class="view">
    <h2 class="text-3xl md:text-4xl font-black mb-8 text-center">Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„ÙƒØ§Ù…Ù„</h2>
    <div id="marketplace-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
  </section>

</main>

<!-- â”€â”€ Cart Drawer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="cart-drawer"
     class="fixed inset-y-0 right-0 w-full max-w-sm bg-white dark:bg-slate-900 shadow-2xl transform translate-x-full transition-transform duration-300 z-50 overflow-y-auto">

  <div class="p-5 md:p-6">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold">Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h3>
      <button onclick="app.toggleCart()" class="text-2xl leading-none hover:text-red-500 transition">Ã—</button>
    </div>

    <div id="cart-items" class="space-y-5 min-h-[200px]"></div>

    <div class="mt-8 pt-6 border-t dark:border-slate-700">
      <div class="flex justify-between text-lg font-bold mb-5">
        <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</span>
        <span id="cart-total">0 Ø¯Ø¬</span>
      </div>
      <button onclick="app.checkout()" class="w-full bg-vendor text-white py-4 rounded-xl font-bold hover:opacity-90 transition">
        ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨
      </button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
class AuresStore {
  constructor() {
    this.state = {
      products: [
        {id:1, name:"Sony Î±7 IV",      price:340_000, cat:"tech",    stock:3,  img:"https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=800"},
        {id:2, name:"Ø¬Ø§ÙƒÙŠØª Ø¬Ù„Ø¯ÙŠ",      price: 18_000, cat:"fashion", stock:10, img:"https://images.unsplash.com/photo-1551028719-00167b16eac5?w=800"},
        {id:3, name:"Razer Blade 16",   price:290_000, cat:"tech",    stock:2,  img:"https://images.unsplash.com/photo-1611078489935-0cb4c2497a00?w=800"},
      ],
      cart: JSON.parse(localStorage.getItem("aures_cart") || "[]"),
      activeCat: "all",
      search: ""
    };

    this.elements = {
      gridHome: document.getElementById("products-grid"),
      gridMarket: document.getElementById("marketplace-grid"),
      cartItems: document.getElementById("cart-items"),
      cartTotal: document.getElementById("cart-total"),
      cartCount: document.getElementById("cart-count"),
      cartDrawer: document.getElementById("cart-drawer"),
      searchInput: document.getElementById("search-input")
    };
  }

  init() {
    this.applyTheme();
    this.bindEvents();
    this.renderAll();
    this.updateCartUI();
  }

  bindEvents() {
    // Ø¨Ø­Ø«
    let debounceTimer;
    this.elements.searchInput.oninput = e => {
      clearTimeout(debounceTimer);
      debounceTimer = setTimeout(() => {
        this.state.search = e.target.value.trim().toLowerCase();
        this.renderAll();
      }, 280);
    };

    // ÙØ¦Ø§Øª
    document.querySelectorAll(".cat-btn").forEach(btn => {
      btn.onclick = () => {
        this.state.activeCat = btn.dataset.cat;
        document.querySelectorAll(".cat-btn").forEach(b => b.classList.remove("bg-ai","text-white"));
        btn.classList.add("bg-ai","text-white");
        this.renderAll();
      };
    });
  }

  show(view) {
    document.querySelectorAll(".view").forEach(v => v.classList.remove("active"));
    document.getElementById(`view-${view}`)?.classList.add("active");
  }

  toggleMobileMenu() {
    document.getElementById("mobile-menu").classList.toggle("hidden");
  }

  toggleTheme() {
    document.documentElement.classList.toggle("dark");
    localStorage.setItem("theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
  }

  applyTheme() {
    if (localStorage.getItem("theme") === "dark") {
      document.documentElement.classList.add("dark");
    }
  }

  sanitize(str) {
    return DOMPurify.sanitize(str, {ALLOWED_TAGS: []});
  }

  renderAll() {
    const filtered = this.state.products.filter(p =>
      (this.state.activeCat === "all" || p.cat === this.state.activeCat) &&
      (!this.state.search || p.name.toLowerCase().includes(this.state.search))
    );

    const html = filtered.map(p => `
      <div class="card bg-white dark:bg-slate-800 rounded-xl overflow-hidden shadow-sm">
        <div class="img-container bg-slate-100 dark:bg-slate-700">
          <img loading="lazy" class="w-full h-full object-cover" 
               src="${this.sanitize(p.img)}" 
               alt="${this.sanitize(p.name)}"
               onerror="this.src='https://via.placeholder.com/400x500?text=Ã—'">
        </div>
        <div class="p-4">
          <h4 class="font-bold text-lg mb-1.5 line-clamp-2">${this.sanitize(p.name)}</h4>
          <div class="text-ai font-black text-xl">${p.price.toLocaleString()} Ø¯Ø¬</div>
          <div class="text-xs opacity-70 mt-1">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${p.stock}</div>
          <button ${p.stock < 1 ? 'disabled' : ''} 
                  onclick="app.addToCart(${p.id})"
                  class="mt-4 w-full py-2.5 rounded-lg font-medium transition
                         ${p.stock < 1 ? 'bg-slate-400 cursor-not-allowed' : 'bg-ai text-white hover:bg-indigo-700'}">
            ${p.stock < 1 ? 'Ù†ÙØ¯' : 'Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©'}
          </button>
        </div>
      </div>
    `).join("");

    this.elements.gridHome.innerHTML = html;
    this.elements.gridMarket.innerHTML = html;
  }

  addToCart(id) {
    const product = this.state.products.find(p => p.id === id);
    if (!product || product.stock < 1) return;

    let item = this.state.cart.find(i => i.id === id);
    if (item) {
      if (item.qty >= product.stock) return alert("Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø© ØºÙŠØ± ÙƒØ§ÙÙŠØ©");
      item.qty++;
    } else {
      this.state.cart.push({ ...product, qty: 1 });
    }

    product.stock--;
    this.updateCartUI();
    this.renderAll(); // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
  }

  removeFromCart(id) {
    const item = this.state.cart.find(i => i.id === id);
    if (!item) return;

    const product = this.state.products.find(p => p.id === id);
    if (product) product.stock += item.qty;

    this.state.cart = this.state.cart.filter(i => i.id !== id);
    this.updateCartUI();
    this.renderAll();
  }

  updateCartUI() {
    localStorage.setItem("aures_cart", JSON.stringify(this.state.cart));

    const count = this.state.cart.reduce((sum, i) => sum + i.qty, 0);
    this.elements.cartCount.textContent = count;

    if (this.state.cart.length === 0) {
      this.elements.cartItems.innerHTML = '<p class="text-center py-12 opacity-60">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>';
      this.elements.cartTotal.textContent = "0";
      return;
    }

    this.elements.cartItems.innerHTML = this.state.cart.map(item => `
      <div class="flex gap-4 bg-slate-50 dark:bg-slate-800 p-4 rounded-xl">
        <div class="flex-1">
          <div class="font-medium">${this.sanitize(item.name)}</div>
          <div class="text-sm opacity-80">${item.price.toLocaleString()} Ø¯Ø¬ Ã— ${item.qty}</div>
        </div>
        <button onclick="app.removeFromCart(${item.id})" class="text-red-500 hover:text-red-700 text-xl leading-none">Ã—</button>
      </div>
    `).join("");

    const total = this.state.cart.reduce((sum, i) => sum + i.price * i.qty, 0);
    this.elements.cartTotal.textContent = total.toLocaleString();
  }

  toggleCart() {
    this.elements.cartDrawer.classList.toggle("translate-x-full");
    if (!this.elements.cartDrawer.classList.contains("translate-x-full")) {
      this.updateCartUI();
    }
  }

  checkout() {
    if (!this.state.cart.length) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©");

    alert("ØªÙ… Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø­Ø§ÙƒØ§Ø©)");
    this.state.cart = [];
    this.updateCartUI();
    this.toggleCart();
    this.renderAll();
  }
}

const app = new AuresStore();
app.init();
window.app = app;
</script>
</body>
</html>